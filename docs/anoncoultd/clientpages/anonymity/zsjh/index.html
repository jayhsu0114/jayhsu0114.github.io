<!DOCTYPE html>
<html>
<head>
    <title>中山資料庫</title>
</head>
<body>
    <h1>中山資料庫</h1>
    <form id="zsjhForm">
        <label for="anonymousContent">匿名內容:</label>
        <input type="text" id="anonymousContent" name="anonymousContent" required>
        <input type="hidden" id="userIP" name="userIP">
        <input type="hidden" id="formId" name="formId" value="zsjh">
        <button type="submit">提交</button>
    </form>

    <script>
        async function getUserIP() {
            const response = await fetch('https://api.ipify.org?format=json');
            const data = await response.json();
            return data.ip;
        }

        document.getElementById('zsjhForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            const ip = await getUserIP();
            document.getElementById('userIP').value = ip;

            const formData = new FormData(this);
            fetch('https://script.google.com/macros/s/AKfycbwC_5HrfS_D8d5QiWnAzga5NYJpYZHjP9jOeE-QJz0_VgayXva7Ss4Nl62atsWaQvmR/exec', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => alert('提交成功！'))
            .catch(error => console.error('提交失敗:', error));
        });
    </script>
</body>
</html>
